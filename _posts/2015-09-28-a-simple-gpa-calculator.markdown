---
title: "一个简陋的 GPA 计算器"
layout: post
date: 2015-09-28
comments: true
published: true
categories: 折腾
tags:
    - GPA
    - EXCEL
---

## 1. 缘起

昨天想计算一下自己的 GPA，却发现中国科学院教育云 sep 网站上的成绩单没有计算 GPA 的功能也没用导出成绩的功能。

没办法，自己算吧。

## 2. 思维的转变

很自然的，第一反应是**笔算**。看到长长的课程单，瞬间觉得这种想法好傻，买电脑是干啥的？

第二反应，我可以用计算器啊！有两种选择：一，蔡军的 Casio 计算器；二，Windows 自带的计算器。（其实跟笔算好像也没什么区别= =）

我虽然知道 Casio 计算器有统计功能，可以求加权平均数，不过具体的按键操作已经忘了。我只是想算个 GPA 而已啊，怎么简单怎么快怎么来吧！遂打开了 Windows 自带的计算器。

![](/assets/images/2015-09-28/cal.png)

然后就是小心翼翼的按键盘的过程，然后，加到第10门课时，我把乘号`*`按成了加号`+`，由于很少使用自带的计算器，我第一反应是按退格键改正，然后发现没用，然后我就按了`C`……

w(ﾟДﾟ)w 什么情况！！！怎么前面的算式全没了！！！而且由于没有按过等于号`=`所以还没有历史记录，坑爹啊！！ （然后想起来加一个数再减一个数也可以啊！！！）

遂对手工完成计算心灰意冷，这种行为太傻了。

明明应该有更聪明的方法。

## 3. 第三反应，**EXCEL**!!!!

Excel 都能被大神用来画高达，用它来算一下 GPA 有什么困难的？

### 3.1 获得数据

首先分析一下 sep 的成绩页面：

![](/assets/images/2015-09-28/sep.png)

它的本质还是一个表格。可以很容易的复制粘贴到 Excel 里面。

这样，第一步就完成了。

### 3.2 处理数据

在成绩单上，成绩是按 A, B, C, D 这样的等级给的。计算 GPA 时，有如下对应规则：

| 等级           | A+     | A     | A-    | B+    | B     | B-    | C+    | C     | C-    | F     | P   | N            |
| :-:            | :-:    | :-:   | :-:   | :-:   | :-:   | :-:   | :-:   | :-:   | :-:   | :-:   | :-: | :-:          |
| 绩点           | 4      | 4     | 3.7   | 3.3   | 3     | 2.7   | 2.3   | 2     | 1.7   | 0     | N/A | 0            |
| 百分制参考标准 | 95-100 | 90-94 | 85-89 | 80-84 | 75-79 | 70-74 | 67-69 | 63-66 | 60-62 | 0 -59 | ≥60 | 未有成绩记录 |

> P代表通过；
> F代表未通过；
> N代表无考核成绩或考核成绩无效，并在成绩单备注栏中注明原因。

怎么把**等级**转换成**绩点**呢？换言之，怎么把有限个**字母**映射为有限个**数字**呢？

这里用到的是 Excel 提供的 **IF 函数**[^1]:


> **IF 函数**
>  
> 使用逻辑函数 IF 函数时，如果条件为真，该函数将返回一个值；如果条件为假，函数将返回另一个值。
>
> **语法**
>
> IF(logical_test, value_if_true, [value_if_false])  

在这个问题上函数式可写为：

~~~
=IF(E9="A+",4,IF(E9="A",4,IF(E9="A-",3.7,IF(E9="B+",3.3,IF(E9="B",3,IF(E9="B-",2.7,IF(E9="C+",2.3,IF(E9="C",2,IF(E9="C-",1.7,0)))))))))
~~~

这里`E9`是某一个记录学分的单元格。然后`F`, `N`, `P`都按`0`算了，浓缩了在最后一个`0`里面。

GPA 其实就是求一个加权平均数。学分为绩点的权重。即：

$$
GPA = \frac{\sum\text{学分}\cdot\text{绩点}}{\sum\text{学分}}
$$

其他的加权、乘除什么的就简单了。

## 4. 分享

算完自己的其实很快就搞定了。然后我问了一下蔡军是怎么算的，发现原来他就是徒手按计算器算的= =。

我就觉得很有必要把这个表格分享出去，可以节约很多人不必要浪费的时间。花了不少时间把最开始一个原始的公式改造成了可以给第一次接触的人使用的 GPA 计算器。分享到QQ群里的时候还是很有成就感的，特别是看到有人下载了，说很赞，很高兴，哈哈。

还有同学反馈给我了第一版 C 等级出来的绩点是 0 的错误，我测试的时候没发现，在这里也谢谢她。

最后，奉上：一个[简陋的 GPA 计算器 ver 0.21](/assets/downloads/2015-09-28/简陋的GPA计算器ver0.21.xlsx)

*ps. 只针对 sep 教务系统，其他教务系统需要稍作改动再使用*

---

 [^1]: [IF 函数的官方文档](https://support.office.com/zh-CN/article/IF-%E5%87%BD%E6%95%B0-69aed7c9-4e8a-4755-a9bc-aa8bbff73be2)